"use strict";_SL.nmspc("login").form=function(){var a={formId:"#formPwdcheck",formAuth:"#formEmailauth",formComuserPwd:"#formComuserPwd",urlSelect:gCONTEXT_PATH+"interface/user_mail_send.do",urlUpdatePwd:gCONTEXT_PATH+"interface/comuser_passwd_upd.do"},b={form:$(a.formId),formAuth:$(a.formAuth),formComuserPwd:$(a.formComuserPwd),emailAuth:$(a.formAuth+" [name=email_auth]"),trPrePwd:$(a.formId+" #tr_pre_passwd"),lblPwd:$(a.formComuserPwd+" #lbl_passwd"),lblPwdConfirm:$(a.formComuserPwd+" #lbl_passwd2"),userId:$(a.formId+" [name=user_id]"),userEm:$(a.formId+" [name=mail_addr]"),userNm:$(a.formComuserPwd+" [name=user_nm]"),telNo:$(a.formComuserPwd+" [name=tel_no]"),mobileNo:$(a.formComuserPwd+" [name=mobile_no]"),prePasswd:$(a.formComuserPwd+" [name=pre_passwd]"),passwd:$(a.formComuserPwd+" [name=passwd]"),rePasswd:$(a.formComuserPwd+" [name=passwd2]"),msg:$(a.formComuserPwd+" #msg"),num:$(a.formId+"  [name=num]"),slKeyId:$(a.formId+" [name=slKey]")},c={pswd:""},d={password:function(a){if(""!=$(a).val()){for(var c=b.userId.val(),d=b.userNm.val(),e=b.telNo.val().replace(/[- ]/g,""),f=b.mobileNo.val().replace(/[- ]/g,""),g=$(a).val(),h=0,i=0,j=0;j<g.length;j++){var k,l,m;j>=2&&(k=g.charCodeAt(j-2),l=g.charCodeAt(j-1),m=g.charCodeAt(j),k-l==-1&&l-m==-1&&i++)}this.message="[비밀번호 생성규칙]<br>① 9자 이상.<br>② 영문 대문자/영문 소문자/숫자/특수문자 중<br>3가지 이상의 문자 조합. <br>③ 아이디와 같을 수 없음. <br>④ abc, 123같은 연속적인 영문, 숫자는<br>3자 이상 입력불가.<br>⑤ 이름, 전화번호, 휴대폰번호 포함 불가<br>",/[가-힣]/.test(g)?this.bValid=!1:g.length<9||g.length>15?this.bValid=!1:g==c?this.bValid=!1:i>0?this.bValid=!1:g.indexOf(d)>-1?this.bValid=!1:e&&g.indexOf(e)>-1?this.bValid=!1:f&&g.indexOf(f)>-1?this.bValid=!1:(/[A-Z]/.test(g)&&h++,/[a-z]/.test(g)&&h++,/[\d]/.test(g)&&h++,/[^A-Za-z0-9]/.test(g)&&h++,h<3&&(this.bValid=!1))}}},e=function(){g(),$.extend(!0,_SL.validate.Validator,d),b.passwd.focus(),$(".ranges-group").keyup(function(){var a=(b.prePasswd.val(),b.passwd.val()),c=b.rePasswd.val();if(a!=c)$("#msg-danger").show();else if(c==a)$("#msg-danger").hide();else if(!_SL.validate(b.form))return})},f=function(){return c.pswd},g=function(){b.form.find(".btn-find").on("click",h),b.formAuth.find(".btn-check").on("click",i),b.formComuserPwd.find(".btn-save").on("click",j)},h=function(){$("body").requestData(a.urlSelect,_SL.serializeMap(b.form),{displayLoader:!0,callback:function(a){var c=a.user_id,d=b.userId.val(),e=b.userEm.val();if(null!=c)b.form.hide(),b.formAuth.show();else{if(""!=d&&""==e)return _alert("이메일을 입력하세요."),void b.userEm.focus();if(""!=e&&""==d)return _alert("아이디를 입력하세요."),void b.userId.focus();_alert("일치하는 정보가 없습니다.</br>관리자에게 문의 바랍니다.",{onAgree:function(){k(!0),b.userId.val("").focus(),b.userEm.val("")}})}}})},i=function(){b.num.val()==b.emailAuth.val()?_alert("인증이 성공하였습니다.",{onAgree:function(){k(!0),b.formAuth.hide(),b.formComuserPwd.show()}}):_alert("인증번호가 일치하지 않습니다.",{onAgree:function(){k(!0),b.emailAunth.val("").focus()}})},j=function(){var d=b.prePasswd.val(),e=b.passwd.val(),f=b.rePasswd.val();if(e!=f)return""!=f&&""==e?(b.msg.show(),_alert("새 비밀번호를 입력하세요."),void b.passwd.focus()):""!=e&&""==f?(_alert("새 비밀번호 확인을 입력하세요."),void b.rePasswd.focus()):(_alert("새 비밀번호가 일치하지 않습니다."),void b.rePasswd.val("").focus());if(d==e)return void _alert("기존 비밀번호와 새 비밀번호가 동일합니다.");if(_SL.validate(b.form)){var g={user_id:b.userId.val(),passwd:b.passwd.val(),slKey:b.slKeyId.val()};$("body").requestData(a.urlUpdatePwd,g,{callback:function(a,d,e){"SUC.COM.0000"==d&&_alert("비밀번호가 변경되었습니다.",{onAgree:function(){c.pswd=b.passwd.val(),b.formAuth.find("[data-layer-close=true]").click(),b.formComuserPwd.find("[data-layer-close=true]").click()}})}})}},k=function(a){a&&b.form.find("[data-layer-close=true]").click()};return{init:e,getPswd:f}}(),$(function(){slapp.login.form.init()});